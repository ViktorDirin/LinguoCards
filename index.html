<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinguoCards</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #0f172a;
            /* Main BG */
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            /* Slate 700 */
            border: 2px solid #0f172a;
            /* Padding effect */
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
            /* Slate 600 */
        }

        /* Firefox */
        * {
            scrollbar-width: thin;
            scrollbar-color: #334155 #0f172a;
        }
    </style>
</head>

<body>
    <div id="app">
        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <!-- Settings Icon (Top Right) -->
            <!-- Settings Icon (Top Right) -->
            <!-- Icon moved to header flex container -->

            <!-- Settings Modal -->
            <div id="settings-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header" style="justify-content: center;">
                        <h2>Settings</h2>
                    </div>
                    <div class="modal-body">
                        <!-- PWA Actions -->
                        <button id="install-app-btn" class="hidden"
                            style="width: 100%; padding: 0.75rem 1rem; background-color: #2563eb; color: white; border-radius: 0.5rem; font-weight: 500; margin-bottom: 1rem; border: none; cursor: pointer; transition: background-color 0.2s;">
                            Install App
                        </button>

                        <button id="check-update-btn"
                            style="width: 100%; padding: 0.75rem 1rem; background-color: #334155; color: #e2e8f0; border-radius: 0.5rem; font-weight: 500; border: none; cursor: pointer; transition: background-color 0.2s; margin-bottom: 1rem;">
                            Check for Updates
                        </button>

                        <!-- Debug Info -->
                        <div
                            style="color: #64748b; font-size: 0.75rem; text-transform: uppercase; margin-top: 1rem; margin-bottom: 0.5rem;">
                            Debug Info
                        </div>
                        <div id="debug-info-log"
                            style="background-color: rgba(2, 6, 23, 0.5); border: 1px solid #1e293b; border-radius: 0.25rem; padding: 0.75rem; font-size: 0.75rem; font-family: monospace; color: #10b981; word-break: break-all; min-height: 60px; margin-bottom: 1.5rem;">
                            Waiting for speech trigger...
                        </div>

                        <div class="version-info"
                            style="text-align: center; margin-bottom: 1.5rem; color: #64748b; font-size: 0.8rem;">
                            v1.3.49
                        </div>

                        <!-- Close Button -->
                        <button id="close-settings-btn"
                            style="width: 100%; padding: 0.75rem 1rem; background-color: transparent; border: 1px solid #475569; color: #94a3b8; border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                            Close
                        </button>
                    </div>
                </div>
            </div>

            <!-- Rules Reference Modal -->
            <div id="rules-modal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header" style="justify-content: center;">
                        <h2 style="color: #38bdf8;">Vietnamese Number Rules</h2>
                    </div>
                    <div class="modal-body" style="text-align: left; color: #cbd5e1; line-height: 1.6;">
                        <ul style="list-style-type: none; padding: 0;">
                            <li style="margin-bottom: 0.75rem;">‚Ä¢ <strong>15.</strong> Spoken as 'm∆∞·ªùi lƒÉm' (instead of
                                nƒÉm).</li>
                            <li style="margin-bottom: 0.75rem;">‚Ä¢ <strong>21, 31... 91.</strong> The '1' becomes 'm·ªët'
                                (instead of m·ªôt).</li>
                            <li style="margin-bottom: 0.75rem;">‚Ä¢ <strong>25, 35... 95.</strong> The '5' becomes 'lƒÉm'
                                (instead of nƒÉm).</li>
                            <li style="margin-bottom: 0.75rem;">‚Ä¢ <strong>24, 34... 94.</strong> Often '4' sounds like
                                't∆∞' (instead of b·ªën).</li>
                            <li style="margin-bottom: 0.75rem;">‚Ä¢ <strong>Tens.</strong> 10 is 'm∆∞·ªùi', but in compounds
                                (20, 30...) it is 'm∆∞∆°i'.</li>
                        </ul>
                        <!-- Close Button -->
                        <button id="close-rules-btn"
                            style="width: 100%; padding: 0.75rem 1rem; background-color: transparent; border: 1px solid #475569; color: #94a3b8; border-radius: 0.5rem; font-weight: 500; cursor: pointer; transition: all 0.2s; margin-top: 1rem;">
                            Close
                        </button>
                    </div>
                </div>
            </div>

            <div class="container">
                <div
                    style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin-bottom: 1rem;">
                    <h1 style="margin: 0;">LinguoCards</h1>

                    <!-- Settings Icon (Flex Item) -->
                    <div style="cursor: pointer; color: #64748b; transition: color 0.2s;"
                        class="text-slate-500 hover:text-slate-300">
                        <svg id="settings-btn" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path
                                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                            </path>
                        </svg>
                    </div>
                </div>
                <p>Select a topic to start learning</p>

                <div id="topic-list" class="topic-grid">
                    <!-- Topics will be injected here -->
                </div>
            </div>
        </div>

        <!-- Learning Screen -->
        <div id="learning-screen" class="screen">
            <header
                style="display: flex; justify-content: center; align-items: center; width: 100%; min-height: 4rem; padding-top: 4rem; margin-bottom: 1rem;">
                <button id="back-home-btn" class="btn-menu"
                    style="position: fixed; top: 1rem; left: 1rem; z-index: 50;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Menu
                </button>
                <span id="progress-indicator">Card 1 of 11</span>
            </header>

            <main class="card-container">
                <div id="flashcard" class="card">
                    <div class="card-face card-front">
                        <button id="speak-btn" class="btn-speak" title="Listen">üîä</button>
                        <div class="card-content">
                            <span class="term-large" id="card-term">M·ªôt</span>
                            <span class="transcription-text" id="card-transcription">[Mot]</span>
                            <span class="category-tag">Numbers</span>
                        </div>
                    </div>
                    <div class="card-face card-back">
                        <div class="card-content">
                            <span class="translation-large" id="card-translation">One</span>
                        </div>
                    </div>
                    <!-- Victory Overlay -->
                    <div id="quiz-victory-overlay" class="hidden"
                        style="position: fixed; inset: 0; background: #0f172a; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100;">
                        <h2 style="font-size: 2.5rem; color: #4ade80; margin-bottom: 0.5rem; font-weight: bold;">R·∫•t
                            t·ªët!</h2>
                        <p style="font-size: 1.25rem; color: #38bdf8; margin-bottom: 2rem;">(Very good!)</p>

                        <h3 class="term-large" style="color: #e2e8f0; margin-bottom: 1rem; font-size: 1.5rem;">Quiz
                            Complete!</h3>
                        <p id="quiz-final-score" style="color: #94a3b8; font-size: 1.1rem; margin-bottom: 2rem;">Result:
                            0/0</p>

                        <button id="quiz-retry-btn" class="btn-primary" style="width: 200px; margin-bottom: 1rem;">Play
                            Again</button>
                        <button id="quiz-exit-btn" class="btn-secondary" style="width: 200px;">Back to Menu</button>
                    </div>
                </div>
            </main>

            <footer class="controls">
                <button id="prev-btn" class="btn-secondary" disabled>Previous</button>
                <button id="next-btn" class="btn-primary">Next</button>
            </footer>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="screen">
            <header
                style="position: relative; padding-top: 4rem; display: flex; align-items: center; justify-content: center; margin-bottom: 2rem;">
                <button id="quiz-back-btn" class="btn-menu"
                    style="position: fixed; top: 1rem; left: 1rem; z-index: 50;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back
                </button>
                <h2 id="quiz-header-title"
                    style="margin: 0; font-size: 1.5rem; color: #e2e8f0; width: 100%; text-align: center; padding: 0 1rem;">
                    Quiz</h2>
            </header>

            <main class="quiz-container" style="justify-content: flex-start; padding-top: 1rem;">
                <div id="quiz-progress"
                    style="width: 100%; text-align: center; color: #94a3b8; font-size: 0.9rem; margin-bottom: 1rem;">
                </div>
                <!-- Audio Trigger -->
                <button id="quiz-play-btn" class="quiz-sound-trigger">
                    üîä
                </button>

                <p style="margin-top: 1rem; color: #64748b; font-size: 0.9rem;">Listen and type the number</p>

                <!-- Display -->
                <div id="quiz-input-display" class="quiz-display"></div>

                <!-- Keypad -->
                <div id="quiz-keypad" class="quiz-keypad">
                    <button class="keypad-btn" data-key="1">1</button>
                    <button class="keypad-btn" data-key="2">2</button>
                    <button class="keypad-btn" data-key="3">3</button>
                    <button class="keypad-btn" data-key="4">4</button>
                    <button class="keypad-btn" data-key="5">5</button>
                    <button class="keypad-btn" data-key="6">6</button>
                    <button class="keypad-btn" data-key="7">7</button>
                    <button class="keypad-btn" data-key="8">8</button>
                    <button class="keypad-btn" data-key="9">9</button>
                    <button class="keypad-btn action" data-key="clear">C</button>
                    <button class="keypad-btn" data-key="0">0</button>
                    <button class="keypad-btn action" data-key="back">‚å´</button>
                </div>

                <button id="quiz-submit-btn" class="btn-primary" style="width: 100%; max-width: 320px;">Submit
                    Answer</button>
            </main>
        </div>

        <!-- Calculator Screen -->
        <div id="calculator-screen" class="screen">
            <header
                style="position: relative; padding-top: 4rem; display: flex; align-items: center; justify-content: center; margin-bottom: 2rem;">
                <button id="calc-back-btn" class="btn-text"
                    style="position: absolute; top: 1rem; left: 1rem; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem; z-index: 10;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Back to Menu
                </button>
                <h2 id="calc-header-title"
                    style="margin: 0; font-size: 1.5rem; color: #e2e8f0; width: 100%; text-align: center; padding: 0 1rem;">
                    Number Calculator</h2>
            </header>

            <main class="quiz-container" style="justify-content: flex-start; padding-top: 1rem;">
                <p style="margin-top: 1rem; color: #64748b; font-size: 0.9rem;">Type any number to hear it in Vietnamese
                </p>
                <div id="calculator-transcription"
                    class="text-xl text-blue-400 font-semibold min-h-[1.5rem] text-center mt-2 px-4 transition-all duration-300"
                    style="font-size: 1.25rem; color: #60a5fa; font-weight: 600; min-height: 1.5rem; text-align: center; margin-top: 0.5rem; padding: 0 1rem; transition: all 0.3s ease; word-break: break-word;">
                </div>

                <!-- Display -->
                <div id="calc-input-display" class="quiz-display" style="border-color: #38bdf8;"></div>

                <!-- Keypad -->
                <div id="calc-keypad" class="quiz-keypad">
                    <button class="keypad-btn" data-key="1">1</button>
                    <button class="keypad-btn" data-key="2">2</button>
                    <button class="keypad-btn" data-key="3">3</button>
                    <button class="keypad-btn" data-key="4">4</button>
                    <button class="keypad-btn" data-key="5">5</button>
                    <button class="keypad-btn" data-key="6">6</button>
                    <button class="keypad-btn" data-key="7">7</button>
                    <button class="keypad-btn" data-key="8">8</button>
                    <button class="keypad-btn" data-key="9">9</button>
                    <button class="keypad-btn action" data-key="clear">C</button>
                    <button class="keypad-btn" data-key="0">0</button>
                    <button class="keypad-btn action" data-key="back">‚å´</button>
                </div>

                <button id="calc-speak-btn" class="btn-primary"
                    style="width: 100%; max-width: 320px; display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                    <span style="font-size: 1.25rem;">üîä</span> Speak
                </button>
            </main>
        </div>
    </div>
    <script src="js/app.js"></script>
</body>

</html>